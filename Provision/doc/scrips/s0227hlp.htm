<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>Scrip 227 - Process and Service Shutdown-Restart</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.1.0  (Win32)">
	<META NAME="AUTHOR" CONTENT="Alessandro Donnini">
	<META NAME="CREATED" CONTENT="20031126;9032256">
	<META NAME="CHANGEDBY" CONTENT="Alessandro Donnini">
	<META NAME="CHANGED" CONTENT="20031126;11041327">
	<STYLE>
	<!--
		TD P { font-family: "verdana"; font-size: 10pt }
		P { font-family: "verdana"; font-size: 10pt }
		H3 { color: #333399; font-family: "verdana" }
		H4 { color: #333399; font-family: "verdana" }
		A:link { color: #333399 }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" LINK="#333399" DIR="LTR">
<H3>Scrip 227 &ndash; <FONT FACE="verdana, helvetica"><FONT COLOR="#333399">Process
and Service Shutdown-Restart</FONT></FONT></H3>
<H4>Overview</H4>
<P>Scrip 227 lets you shut down, and optionally restart, any
combination of processes and services on one, some, or all systems at
a site. 
</P>
<P>The shutdown and restart operations can be performed on demand, or
on a schedule making this Scrip a powerful remote system management
tool. 
</P>
<H4>How it works</H4>
<P>Scrip 227&rsquo;s structure follows a pattern that ASI users will
find familiar. 
</P>
<P>First you define, separately, process groups and service groups.
As the names of these configuration parameters suggest, they let you,
respectively, group processes that you may want to shutdown and/or
restart together. Because we support standard MS-DOS wild card
characters, and the exclusion character, <B>!</B>, you have great
flexibility in managing the shutdown/restart of processes and
services on systems at a site. Please refer to Scrip 227&rsquo;s
configuration help file for detailed information on process and
service group definition.</P>
<P>Next, you use the On-demand/Scheduled Shut down/Restart parameters
(four in all) to define the lists of processes/services that you want
to shutdown/restart on demand, or on a schedule. Scrip 227 lets you
mix process and service groups in the shutdown/restart lists. You can
also have the same process(es) and service(s) in different groups.</P>
<P>At this point, you set the schedule for the scheduled
shutdown/restart operations and you are done.</P>
<H4>Scrip 227 operation</H4>
<P>Scrip 227 can have a <EM><FONT FACE="Arial Black">bimodal</FONT></EM>
mode of operation. It can be used to perform remotely and
automatically the following functions:</P>
<UL>
	<LI><P><EM><FONT FACE="Verdana"><FONT COLOR="#000000">Scheduled
	shutdown</FONT></FONT></EM>. In this mode, Scrip 227 would be used,
	for example, to perform an orderly shutdown of all active
	applications before starting a regularly scheduled backup process.
	To use the Scrip this way, it is enabled, and the schedule is set up
	to run as desired. 
	</P>
	<LI><P><EM><FONT FACE="Verdana"><FONT COLOR="#000000">On-demand
	shutdown</FONT></FONT></EM>. In this mode, Scrip 227 would be used,
	for example, if a notification generated by the ASI server, or other
	alert (or a phone call) informed an administrator that he/she needed
	to shut down certain process(es) and/or service(s) remotely. To use
	the Scrip to perform this action, it does not have to be enabled.
	The administrator simply clicks on the <EM><FONT FACE="Verdana"><FONT COLOR="#000000">Execute</FONT></FONT></EM>
	button to the right of the <EM><FONT FACE="Verdana"><FONT COLOR="#000000">Shut
	down processes now</FONT></FONT></EM> label to shut down the
	process(es) and/or service(s). 
	</P>
</UL>
<P>Other elements of Scrip 227&rsquo;s function that make it a
reliable and versatile system management tool include:</P>
<UL>
	<LI><P>When shutting down an executable, Scrip 227 saves the exact
	location of the executable and its command line parameters, so that
	it could be restarted in a state that is as close as possible to its
	pre-shutdown state. 
	</P>
	<LI><P>Scrip 227 shuts down services in the order in which they
	appear in a service group entry. It will restart them in the reverse
	order. In this way, dependent services are shut down first and
	restarted last.</P>
	<LI><P>Scrip 227 will restart only one instance of each process it
	shut down, regardless of the number of instances that were running
	at the time. For example, if the Scrip shut down four copies of
	Microsoft Internet Explorer, it will restart only one.</P>
	<LI><P>Scrip 227 will restart only processes that were successfully
	shut down.</P>
	<LI><P>Scrip 227 lets you selectively restart processes that it shut
	down. For example, you can configure it to shut down *.exe but only
	restart foo.exe.</P>
</UL>
<P>The table below describes the information contained in the logs
produced by this Scrip.</P>
<TABLE BORDER=1 BORDERCOLOR="#c0c0c0" CELLPADDING=3 CELLSPACING=0>
	<TR>
		<TD>
			<P><STRONG>Client time:</STRONG></P>
		</TD>
		<TD>
			<P>Date and time at which event was detected by the Client on the
			end-user system (e.g. 2001-03-02 19:21:36)</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Server time:</STRONG></P>
		</TD>
		<TD>
			<P>Date and time at which event log was received and stored in the
			SQL database on the Web log server (e.g. 2001-03-02 19:21:53)</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Scrip number:</STRONG></P>
		</TD>
		<TD>
			<P>Number of Scrip (no particular relevance) 
			</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Customer:</STRONG></P>
		</TD>
		<TD>
			<P>Name of supported customer, individual department or site 
			</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Machine:</STRONG></P>
		</TD>
		<TD>
			<P>Name of system as assigned at the time of Windows configuration
						</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Username:</STRONG></P>
		</TD>
		<TD>
			<P>Name of user when event occurred 
			</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Client version:</STRONG></P>
		</TD>
		<TD>
			<P>Client version number (e.g. 0.700.2048.LE) 
			</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Client size:</STRONG></P>
		</TD>
		<TD>
			<P>Size of Client in bytes 
			</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Priority:</STRONG></P>
		</TD>
		<TD>
			<P>Priority of event ranging between 1 (lowest) and 9 (highest) 
			</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Description:</STRONG></P>
		</TD>
		<TD>
			<P>Description of event that took place (e.g. symptom detected,
			problem resolved or automated procedure executed) 
			</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Type:</STRONG></P>
		</TD>
		<TD>
			<P>n/a</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Path:</STRONG></P>
		</TD>
		<TD>
			<P>n/a</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Executable:</STRONG></P>
		</TD>
		<TD>
			<P>n/a</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Version:</STRONG></P>
		</TD>
		<TD>
			<P>n/a</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Size:</STRONG></P>
		</TD>
		<TD>
			<P>n/a</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>ID:</STRONG></P>
		</TD>
		<TD>
			<P>n/a</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Window title:</STRONG></P>
		</TD>
		<TD>
			<P>n/a</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>String 1:</STRONG></P>
		</TD>
		<TD>
			<P>n/a</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>String 2:</STRONG></P>
		</TD>
		<TD>
			<P>Client location on system that reported the event 
			</P>
			<P>(e.g. C:\PROGRAM FILES\...\CLIENT\CUST.EXE) 
			</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Text 1:</STRONG></P>
		</TD>
		<TD>
			<P>Log of actions taken by Scrip 227</P>
			<P>(E.g.</P>
			<P>Shutting down the processes in this group: office<BR>Restarting
			the processes in this group: office 
			</P>
			<P>)</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Text 2:</STRONG></P>
		</TD>
		<TD>
			<P>n/a</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Text 3:</STRONG></P>
		</TD>
		<TD>
			<P>n/a</P>
		</TD>
	</TR>
	<TR>
		<TD>
			<P><STRONG>Text 4:</STRONG></P>
		</TD>
		<TD>
			<P>Listing of all processes and services shutdown and restarted by
			Scrip 227</P>
			<P>(E.g.</P>
			<P>Data: Shutdown C:\PROGRAM FILES\INTERNET
			EXPLORER\IEXPLORE.EXE<BR>Data: Shutdown C:\PROGRAM FILES\MICROSOFT
			OFFICE\OFFICE\EXCEL.EXE<BR>Data: Shutdown C:\PROGRAM
			FILES\MICROSOFT OFFICE\OFFICE\WINWORD.EXE<BR>Data: Shutdown
			C:\PROGRAM FILES\MICROSOFT OFFICE\OFFICE\POWERPNT.EXE<BR>Data:
			Shutdown C:\PROGRAM FILES\MICROSOFT
			OFFICE\OFFICE\OUTLOOK.EXE<BR>Data: Shutdown C:\PROGRAM
			FILES\MICROSOFT OFFICE\OFFICE\FRONTPG.EXE<BR>Data: Shutdown
			C:\PROGRAM FILES\INTERNET EXPLORER\IEXPLORE.EXE<BR>Data: Starting
			C:\PROGRAM FILES\MICROSOFT OFFICE\OFFICE\FRONTPG.EXE<BR>Data:
			Starting C:\PROGRAM FILES\MICROSOFT
			OFFICE\OFFICE\OUTLOOK.EXE<BR>Data: Starting C:\PROGRAM
			FILES\INTERNET EXPLORER\IEXPLORE.EXE<BR>Data: iexplore.exe is
			already running<BR>Data: Starting C:\PROGRAM FILES\MICROSOFT
			OFFICE\OFFICE\POWERPNT.EXE<BR>Data: Starting C:\PROGRAM
			FILES\MICROSOFT OFFICE\OFFICE\EXCEL.EXE<BR>Data: Starting
			C:\PROGRAM FILES\MICROSOFT OFFICE\OFFICE\WINWORD.EXE 
			</P>
			<P>)</P>
		</TD>
	</TR>
</TABLE>
<P><BR><BR>
</P>
</BODY>
</HTML>