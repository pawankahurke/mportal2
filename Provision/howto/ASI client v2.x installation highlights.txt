ASI Client Version 2.x Installation and Upgrade Highlights
===========================================================

1) Site registration code

When you run the ASI client installation executable manually on a system where it is not yet installed, Scrip 223 (ASI Client Installation and Deployment) will generate a dialog box asking for the registration code of the site where you are installing the ASI client.

If the ASI client is installed on a system connected to a sub-net where the ASI client is already installed and running on other systems, it performs a series of tasks to facilitate the site registration code entry process:
i) If the ASI client sees responses to the broadcast it sends after the with execution of the installation executable is completed with more than one site code, then it will leave the site registration code box in the dialog box empty, and the dialog box includes the message:  "No default is provided because multiple codes are currently accessible on this sub-net".
ii) If the ASI client doesn't see any responses to its broadcast, it doesn't enter any suggested site code, and the dialog box includes the message: "No default code is provided because no codes are currently accessible on this sub-net".
iii) If the ASI client sees responses to its broadcast with only one site registration code, it uses that site registration code as a suggested value, and the dialog box includes the message: "The default code provided is the only one currently accessible on this sub-net". Please note that the person performing the installation needs to explicitly accept the suggested site registration code value.
iv) If the suggested site registration code in iii) is one generated by the ASI client, as in the case of versions of the ASI client that are installed using a custom installation executable (one that has a cust.ini file), then it will be used as the suggested site registration code. However, if the person performing the installation enters a legacy code, the ASI client installation and deployment Scrip will reject it, and the rejection is accompanied by a dialog box that says: "Site registration codes for sites where the ASI client was originally installed with a custom installation executable are not valid".

Scrip 223 checks the internal consistency of the site registration code, using the check digit, and keeps asking until it gets one that is internally consistent. 

Please note that as many as 15-30 seconds elapse from execution of the ASI client installation executable until the dialog box asking for the ten-digit site registration code is displayed.

If you run the ASI client installation executable on multiple systems at the same time (e.g. via a login script), the dialog box will be generated on all the systems. This dialog box has a timeout. It automatically goes away after 60 minutes. Then, after 15 minutes, the systems on which it went away, will retry to obtain a valid site registration code, bringing up the dialog box again. This cycle is repeated until a valid site registration code is either entered by the person performing the installation, or obtained from a neighboring system and accepted by the person performing the installation.

If you install the ASI client via a batch file or login script using the /ID option (See 2b) below) in the ASI client installation executable command line, the dialog box asking for the site registration code will not be generated. You will have to make sure that the site registration code used in the command line is correct. Otherwise, you run the risk that the wrong site registration code be used.

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

2) ASI client installer

The ASI client installer supports a number of command line options:

a) /VERYSILENT  --  CASE SENSITIVE
It makes the installation silent. 
The only exception are 
* The progress dialog boxes displayed when the ASI network driver is installed for the first time on Microsoft Windows NT4 systems during the "driver binding" step that occurs twice.

* The system function that installs the driver on Microsoft Windows 2000, XP, or Server 2003 displays progress dialog boxes about the copy of the driver files. These appear only for a few seconds (in some cases less than one second).

Both types of dialog boxes above are system dialog boxes and are therefore unaffected by the /VERYSILENT command line switch of the installer.

b) /ID=XXXXXXXXXX  --  CASE INSENSITIVE
It lets you enter the registration code for a site in the installer's command line eliminating the need for any user interaction. The letters in ID are not case sensitive.  You can have iD, Id, id etc... There should not be any spaces in the string. There should only be a space that separates the name of the ASI client installation executable file from the command line argument. 

For example:
hfn-inst-160665.exe /ID=XXXXXXXXXX

Please note that you could install the ASI client with a specific site registration code with requiring input of the code interactively, or via command line by adding:

-<site id>
to the ASI client installation executable file name. For example:

hfn-1234567890-inst-2.004.029.0156.00.exe
will install the ASI client with site id = 1234567890

or, if you rename the above file to abc.exe,

abc-1234567890.exe
will also install the ASI client with site id = 1234567890`

c) /CI controlling the request of end-user contact information  --  CASE INSENSITIVE
Adding  /CI=1 parameter to the ASI client installation executable command line will cause the ASI client to generate a dialog box, as soon as the installation process is completed, asking a system's user to enter the contact information you selected when you configured Scrip 241. By default, the only information requested is first name and last name. Using /CI=0 prevents the request for contact information explicitly. Not including the /CI variable in the ASI client installation executable command line is equivalent to using /CI=0.  CI stands for "contact information". The letters in CI are not case sensitive.

Please note that regardless of whether you use the CI command line variable at installation time or not, you can always ask for an end-user's contact information at any time by running Scrip 241 on demand. Doing this will cause Scrip 241 to generate a dialog box requesting the contact information. Please refer to the Scrip 241 configuration help file for detailed information about Scrip 241.

d) /DEPLOY controlling the ASI client network deployment function (Scrip 111)  --  CASE SENSITIVE

/DEPLOY=1 enables the HandsFree network deployment function at start-up.

/DEPLOY=0 disables the HandsFree network deployment function at start-up. You can run it later by directly accessing the Scrip 111 configuration page (not using a /DEPLOY command line option has the same effect as using /DEPLOY=0).

If you used the /DEPLOY=1 command line option when running the ASI client installation executable, the ASI client network deployment function (Scrip 111) will run on ASI client startup. Upon (one-time) execution, Scrip 111 generates a dialog box with three text fields. In these text fields you enter the user name, domain, and password for a user with administrative rights on all systems where you want the ASI client installed. Once the requested information is entered, and you click on the "OK" button, the Scrip will initiate ASI client deployment on the sub-net. The dialog box generated by Scrip 111 persists until you enter the requested information, and click on the "OK" button, or click on the "Cancel" button.


e) /NDS controlling the installation of the ASI network driver  --  CASE INSENSITIVE
/NDS=0
If present in the ASI client installation executable command line, the /NDS=0 switch will prevent the installation of the ASI network driver on systems where the ASI client is not yet installed, or where the ASI network driver was not previously installed. On systems where the ASI network driver is installed, using the /NDS=0 switch in the ASI client installation executable command line will result in the removal of the ASI network driver. The letters in NDS are not case sensitive.  

PLEASE NOTE THAT REMOVING THE ASI NETWORK DRIVER WILL CAUSE THE NETWORK CONNECTIONS ON THE SYSTEM WHERE IT IS BEING REMOVED FROM TO BE RESET. THIS ACTION IS PERFORMED BY THE OPERATING SYSTEM INDEPENDENTLY OF ANY ACTION TAKEN BY THE ASI SOFTWARE.

/NDS=1
If present in the ASI client installation executable command line, the /NDS=1 switch will force the installation of the ASI network driver on systems where the ASI client is not yet installed, or where the ASI network driver was not previously installed. The letters in NDS are not case sensitive.

For example:
hfn-inst-173228.exe /NDS=0

If neither the /NDS=0 or /NDS=1 options are used, the ASI client installation executable will install the ASI network driver on systems where the ASI client was not previously installed, and on system where the ASI client is already installed it will leave the ASI client in its current state with regard to the ASI network driver.

e) /OINI controlling the installation of the ASI client on systems where it is already installed  --  CASE INSENSITIVE
Adding  /OINI parameter to the ASI client installation executable command line will cause the ASI client to terminate the installation if the ASI client installation executable determines that an ASI client is already installed on the system, regardless of version. The letters in OINI must all be upper case.  

If the /OINI option is not used, the ASI client installation executable will install the ASI client regardless of whether it is already installed or not.

The /VERYSILENT, /ID, /CI, /NDS, /DEPLOY, and /OINI command switches can be used in the same command line. When using any of the ASI client installer command line switches, there should not be any spaces in the command line switch string. There should only be a space separating the name of the ASI client installation executable file from the command line argument, and the command line switches from each other, if you are using more than one. 

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

3) Login script

If you want to install version 2.x of the ASI client via a login script, here is a login script fragment that you can use in login.bat (please note that you have to replace the path \\server\software with the path to the location where the ASI client installation executable is located).

--------------------------

@echo off
rem Check if already installed.
if exist "C:\Program Files\HandsFree\Client\cust.exe" goto alldone

rem Not installed.  Run silent install.
\\server\software\hfn-inst-210981.exe /VERYSILENT /ID=<site id number>

:alldone

--------------------------

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

4) ASI network driver installation

With version 1.7 (or later), installation of the ASI client on new systems, or ones with version 1.5, or earlier, will not cause a reset of the system's network connections. 

The only exception to the above is on systems running the Microsoft Windows Server 2003 operating system. There is a bug in MS Windows Server 2003 that prevents us from using our new "quiet" driver installation on systems running this operating system when the Microsoft service called "Network Load Balancing" is installed and enabled. Please refer to 
http://groups.google.com/groups?hl=en&ie=UTF-8&threadm=b7851012.0401010749.24405d20%40posting.google.com
for more details on this issue.

By default, "Network Load Balancing" is installed but not enabled. If it is enabled, the ASI network driver will be installed using the method used in v1.6 of the ASI client. As you know, the downsides of that installation are:
i)  It resets active network connections
ii) It brings up the dialog boxes related to the "driver signing" process

Installation of the network driver causes the following events:

a) The system function that installs the driver on Microsoft Windows 2000, XP, or Server 2003 displays progress dialog boxes about the copy of the driver files. These appear only for a few seconds (in some cases less than one second).

b) Driver installation on Microsoft Windows NT4 systems requires a "driver binding" step that occurs twice.  Each instance displays a progress dialog box for several seconds.

Both types of dialog boxes above are system dialog boxes and are therefore unaffected by the /VERYSILENT command line switch of the installer.

Please note that after an ASI network device driver initial installation or update on systems running any version of Microsoft Windows (NT based, 9x, or Me), all ASI client functions dependent on the ASI network device driver will not be available until the next system reboot.  However, all other ASI client functions will be working normally. If the ASI client installation is performed manually, it will display a dialog box indicating the need to reboot the system in order for all ASI client functions to be available. The ASI client will always log this event on the ASI server. Once the system is rebooted, all ASI network device driver related functionality of the ASI client will be available.

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

5) Disabling and removing the ASI network driver

AFTER READING THE INSTRUCTIONS BELOW, IF YOU ARE NOT SURE ABOUT ANY OF THE ACTIONS DESCRIBED, PLEASE CONTACT HANDSFREE NETWORKS BEFORE DOING ANYTHING.

If you think that a system where the ASI client is installed may be having a problem caused by the ASI network driver, in order to diagnose the problem the first you might want to do is first unload the dynamic component of the ASI network driver which makes it possible for all Scrips that depend on the ASI network driver to work. If unloading the dynamic component of the ASI network driver does not resolve the problem the next step is to remove the ASI network driver completely.

If the system is running, and the ASI client is running, then the easiest way to perform the stesp described in the paragraph above is to use Scrip 201. To unload the dynamic component of the ASI network driver, just click on the "Execute button to the right of the "Unload dynamic driver" label making sure that you click on the "Local" radio button before clicking on the "Execute" button. To completely remove the ASI network driver from a system, just click on the "Execute" button to the right of the "Uninstall network driver" label making sure that you click on the "Local" radio button before clicking on the "Execute" button. After performing either step, or both, to be on the safe side, restart the ASI client using Scrip 18. If you have the time and the situation is not an emergency, then performing these steps one at a time to see if the first one fixes the problem is the best approach.

If the system is running, but the ASI client is not usable, then you can use the Service Manager to stop the Handsfree service (also set the startup mode to "Manual" to prevent it from restarting when you restart the system). This prevents both the dynamic component of the ASI network driver and the ASI client from being loaded. If the system is still having a problem, then the static component of the ASI network driver may be its cause. In this case, the easiest way to uninstall the ASI (static) network driver is to execute the following MS-DOS command line:

[drive]:\Program Files\Handsfree\Client\cutil.exe -x

If this doesn't work, then you can use the Network Control Panel to uninstall the driver. On systems running Microsoft Windows NT4, it is a "Protocol", on all other Microsoft Windows based operating systems (2000, XP, and 2003) it is a "Service". In both cases, you click on it and then click on the "Uninstall" button.

After uninstalling the static driver, it's advisable to restart the system.

If the system won't start, then you can start it in safe mode without network support and just delete the static driver file, which is in the directory \winnt\system32\drivers and has the name nwnt.sys, nw2k.sys, or nwxp.sys depending on your operating system.  You can also set the startup mode
of the service to "Manual" to prevent the ASI client and network driver from restartng when you restart the system.

If the system won't start and it is running the Microsoft Windows NT4 operating system, resolving the issue is more complicated. This could happen because NT4 does not have a safe mode. In this case, please contact Allan Miller (603-249-8886, amiller@handsfreenetworks.com).

Please note that if someone installs the ASI network driver using Scrip 201 after you may have uninstalled it manually in some other way (see above), the ASI client will re-install the ASI network driver. This is something you have to be aware of or you will not understand why the static component of the ASI network driver keeps coming back after you have removed it.

PLEASE KEEP IN MIND THAT REMOVING THE ASI NETWORK DRIVER WILL CAUSE THE NETWORK CONNECTIONS ON THE SYSTEM WHERE IT IS BEING REMOVED FROM TO BE RESET. THIS ACTION IS PERFORMED BY THE OPERATING SYSTEM INDEPENDENTLY OF ANY ACTION TAKEN BY THE ASI SOFTWARE.