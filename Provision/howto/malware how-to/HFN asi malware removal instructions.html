<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>This document provides a step-by-step description of the process you can use to neutralize malware from systems at your sites using the Automated Support Infrastructure (ASI).</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.3  (Win32)">
	<META NAME="CREATED" CONTENT="20040929;13000953">
	<META NAME="CHANGED" CONTENT="20071202;14432155">
	<META NAME="ProgId" CONTENT="Word.Document">
	<META NAME="Originator" CONTENT="Microsoft Word 9">
	<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Alessandro Donnini</o:Author>
  <o:LastAuthor>Alessandro Donnini</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>3</o:TotalTime>
  <o:Created>2004-10-06T23:26:00Z</o:Created>
  <o:LastSaved>2004-10-06T23:26:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>522</o:Words>
  <o:Characters>2976</o:Characters>
  <o:Lines>24</o:Lines>
  <o:Paragraphs>5</o:Paragraphs>
  <o:CharactersWithSpaces>3654</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
	<STYLE TYPE="text/css">
	<!--
		@page { size: 8.5in 11in }
		P { color: #000000; font-family: "verdana"; font-size: 10pt }
		H3 { color: #333399; font-family: "verdana" }
		H4 { color: #333399; font-family: "verdana" }
		H5 { color: #333399; font-family: "verdana" }
		A:link { color: #333399 }
		A:visited { color: #800080 }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" TEXT="#000000" LINK="#333399" VLINK="#800080" DIR="LTR">
<H3>ASI Malware Neutralization Instructions</H3>
<P STYLE="margin-bottom: 0.17in">This document provides a
step-by-step description of the process you can use to neutralize
malware from systems at your sites using the Automated Support
Infrastructure (ASI).</P>
<P STYLE="margin-bottom: 0.17in">In the next section we will outline
the process steps. 
</P>
<H4>ASI malware management and control process overview</H4>
<P><B>Unless stated otherwise, in any of the steps of the ASI malware
management and control process where you are asked to execute a Scrip
make sure that you select &ldquo;machine &lt;machine name&gt;&rdquo;
from the pull-down list to the right of the <I>Execute</I> button.
This is not absolutely necessary but avoids generating unnecessary
event logs.</B></P>
<P><B>Whenever you perform a step where you either run a Scrip or
change the configuration of a Scrip wait until the Scrip execution
command or Scrip configuration change is processed by the ASI client
on the system you are working on. This is a key reason for changing
the Scrip 177 (Scrip Configuration Update) configuration in step 2
below in the <I>Malware protection phase</I> section.</B></P>
<P>The ASI malware management and control process consists of two
main phases:</P>
<P>First, in order for the neutralization of malware to be effective,
</P>
<UL>
	<LI><P>Use Scrip 27 (Start-up Environment Control) and Scrip 232
	(Intrusion Protection Control) to protect systems from malware
	intrusion to ensure that any future attempts to infect a system will
	be neutralized in real-time, as they happen. We call this the
	<B>malware protection phase</B>.</P>
</UL>
<P>Then,</P>
<UL>
	<LI><P>Once the Scrip 27 and 232 <B>protection barriers</B> are
	erected, using Scrip 233 (System Start-up Environment Management)
	and Scrip 240 (Intrusion Protection Management) remove all existing
	malware <B>hooks</B> from systems . By <B>hooks</B>, we mean all the
	items malware add to a system's configuration, e.g. Start-up
	environment items and browser helper objects, that embed the malware
	into a system, let them perform their actions, and make them
	difficult to neutralize. We call this the <B>malware neutralization
	phase</B>.</P>
</UL>
<P>The next section covers the configuration of the ASI malware
protection functions.</P>
<H4>Malware protection phase</H4>
<OL>
	<LI><P>If you want to use a third-party utility such as Ad-aware or
	Spybot to remove malware from system(s) at your sites before using
	ASI's malware neutralization and protection functions make sure that
	either:</P>
	<UL>
		<LI><P>You run the third-party utility <B>BEFORE</B> you install
		the ASI client</P>
	</UL>
	<P>or</P>
	<UL>
		<LI><P>If the ASI client is already installed at your sites, you
		run the third-party utility <B>BEFORE</B> you change the
		configuration of Scrips 27 and 232 to enable protection as
		described in steps 3. and 4. below.</P>
	</UL>
	<LI><P>Ensure that on at least two systems Scrip 177 (Scrip
	Configuration Update) is scheduled to contact your ASI server for
	changes every three minutes. This will ensure that malware
	neutralization actions are processed quickly.</P>
	<LI><P>On each system where you want to neutralize malware, change
	the Scrip 27 (Start-up Environment Control) configuration to enable
	protection as shown in the screen shot below.</P>
</OL>
<P><IMG SRC="HFN%20asi%20malware%20removal%20instructions%2007_html_m722d9254.gif" NAME="graphics1" ALIGN=LEFT WIDTH=593 HEIGHT=376 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<OL START=4>
	<LI><P>On each system where you want to neutralize malware, change
	the Scrip 232 (Intrusion Protection Control) configuration to enable
	protection as shown in the screen shot below.</P>
</OL>
<P><IMG SRC="HFN%20asi%20malware%20removal%20instructions%2007_html_51db7a79.gif" NAME="graphics2" ALIGN=LEFT WIDTH=568 HEIGHT=327 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<P>You should make the configuration changes in steps 3 and 4 above
as soon as possible so that future malware intrusions will be
prevented and won't undo the malware neutralization actions taken
with either a third-party utility, or Scrip 233 (System Start-up
Environment Management) and Scrip 240 (Intrusion Protection
Management), or both. 
</P>
<P>The completion of step 4 marks the end of the malware protection
phase. Next, we will describe the basic malware neutralization phase.</P>
<H4>Basic malware neutralization phase</H4>
<P>Now, you can the start malware neutralization phase where you will
be disabling existing malware hooks from systems at your sites. <B>You
will need to perform steps 5. and 6. only if the </B><I><B>Start-up
items to disable</B></I><B> configuration parameter of Scrip 233, and
the </B><I><B>Items to disable</B></I><B> configuration parameter of
Scrip 240, respectively, are empty.</B> If they are already
populated, you should simply run the Scrips clicking on the <I>Update
startup items now</I>, and the <I>Update intrusion protection now</I>
Execute buttons, respectively.</P>
<OL START=5>
	<LI><P>In the <I>Start-up items to disable</I> configuration
	parameter of Scrip 233 (System Start-up Environment Management),
	paste all content of the file <A HREF="Scrip%20233%20items%20to%20disable%20entries.txt" TARGET="_blank"><B>Scrip
	233 items to disable.txt</B></A>. This file contains known malware
	items that have been disabled at other ASI sites. Next, run the
	Scrip on demand using the <I>Execute</I> button in its configuration
	page (selecting <B>site &lt;site name&gt;</B> from the pull-down
	list to the right of the Execut button).</P>
	<LI><P>In the <I>Items to disable</I> configuration parameter of
	Scrip 240 (Intrusion Protection Management), paste all content of
	the file <A HREF="Scrip%20240%20items%20to%20disable%20entries.txt" TARGET="_blank"><B>Scrip
	240 items to disable.txt</B></A>. This file contains known malware
	items that have been disabled at other ASI sites. Next, run the
	Scrip on demand using the <I>Execute</I> button in its configuration
	page (selecting <B>site &lt;site name&gt;</B> from the pull-down
	list to the right of the Execut button).</P>
</OL>
<P>The completion of step 6 marks the end of the basic ASI malware
neutralization phase, and of the basic ASI malware management and
control process. 
</P>
<P>End-to-end, the basic ASI malware management and control process
should take no more than 10 minutes for all of your sites, regardless
of the number of sites, because all the Scrip configuration changes
are site wide, and will be propagated automatically from one system
to all others at a site, and can be exported in a single step from
one site to all other sites.</P>
<P>Typically, the basic ASI malware management and control process
should be sufficient for most systems at most sites. Afterward, you
can respond to end-user feedback (backed by inspection of ASI event
logs) about the persistence of pop-ups and other evidence of
continuing malware infection, such as degraded system or application
performance, with additional clean-up actions on a system-by-system
basis, using the process described in the next section.</P>
<H4>Malware executables execution termination, quarantine, or removal</H4>
<P>Both Scrips 27 and 232 give you the option to terminate execution,
delete, or quarantine executables that attempt to change the areas
protected by the Scrips.</P>
<P>These are powerful functions, and should be used with care. To
start with, we would suggest that you use the <I>Attempt to terminate
processes that try to change protected registry items</I>, or the
<I>Attempt to quarantine processes that try to change protected
registry items (after termination)</I> functions instead of the
<I>Attempt to delete processes that try to change protected registry
items (after termination)</I> function.</P>
<P>Quarantined items are stored in the <I>27</I> and <I>232</I>
hidden directories in the <I>\Program Files\HandsFree\Client</I>
directory.</P>
<P>Executables listed in the List of processes that will never be
terminated configuration parameter take precedence over those listed
in the List of processes that may be terminated configuration
parameter. This means that if an executable is listed in both
configuration parameters, its execution will NOT be terminated.</P>
<H4>Advanced ASI malware management and control process</H4>
<P>The decision to perform advanced ASI malware management and
control actions depends on a number of considerations including:</P>
<UL>
	<LI><P>The malware protection services you have contracted to
	provide to your customers. The higher the price of the malware
	protection services the more pro-active the malware neutralization
	phase should be.</P>
	<LI><P>The degree and nature of the malware infection.</P>
</UL>
<P>Based on experience to date, the advanced ASI malware management
and control process takes between 10 and 30 minutes per system. The
process described below applies to one system although additions made
to the <I>Items to be disabled</I> configuration parameter in Scrips
233 (System Start-up Environment Management) and 240 (Intrusion
Protection Management) for one system are immediately added to the
<I>Items to be disabled</I> variable for all systems at its site as
<B>site &lt;name&gt;</B> is selected from the <I>Group</I> pull-down
list for the <I>Items to be disabled</I> configuration parameter.</P>
<P>As you will see when reading the rest of this document, in a
number of cases we give estimates and approximations based on our
experience as, for example, when we define a file Last Modified Date
to be <B>recent</B> when it is within the past three months. As you
gain experience with the ASI malware management and control process
you can refine and modify these definitions based on your own
experience.</P>
<P>Over time, you can also alter the sequence of malware
neutralization steps described below to better match your needs, and
reflect your experience. To start with, you should try to follow it
to the letter.</P>
<OL>
	<LI><P><B>We assume that you have completed the basic ASI malware
	management and control process. If you have not done this, please do
	it BEFORE proceeding with the advanced ASI malware management and
	control process.</B></P>
	<LI><P>Open the Scrip 233 (System Start-up Environment Management)
	and Scrip 240 (Intrusion Protection Management) items to be disabled
	master lists that we provided you with (<A HREF="Scrip%20233%20items%20to%20disable%20entries.txt" TARGET="_blank">Scrip
	233 items to disable entries.txt</A>, and <A HREF="Scrip%20240%20items%20to%20disable%20entries.txt" TARGET="_blank">Scrip
	240 items to disable entries.txt</A>), an empty text file, and the
	Scrip 233 and 240 malware item text file for the system your are
	working on. You can create this last file using the template we
	provided you with (<A HREF="system%20xxxxxx%20-%20yyyyyy%20-%20233-240%20items.txt" TARGET="_blank"><B>system
	xxxxxxx &ndash; site yyyyyy &ndash; Scrip 233 and 240 items.txt</B></A>).</P>
	<LI><P>Run Scrip 93 (Report Running Processes) on demand. Retrieve
	the Scrip 93 event log containing the list of currently running
	processes on the system where you are going to neutralize malware.
	Identify processes with <I>recent</I> Last Modified Date (within the
	past three months) and a <B>(not available)</B> Process Version. Run
	searches for the name of suspicious processes using a search engine
	such as Google. The name of every process that is confirmed to be
	malware by the search engine search, or returns no results, should
	be pasted into the empty text file you opened in step 2.</P>
</OL>
<P STYLE="margin-left: 0.51in">Note that in some cases, processes may
have a process version, and a recent Las Modified Date (within the
past three months). In some of these cases, the process in question
may still be malware. You can verify this by conducting a search for
the process name using a search engine like Google.</P>
<P STYLE="margin-left: 0.51in">The names of processes should be
entered into the empty text file as a comma separated list with no
spaces (use a simple text editor like Microsoft Notepad). This list
will be used as the content for an entry into the <I>Process groups</I>
configuration parameter in Scrip 227 (Process and Service
Shutdown-Restart)</P>
<HR>
<OL START=4>
	<LI><P>Access the Scrip 233 configuration page for the system you
	are working on (via the ASI server or locally). Examine the entries
	in the <I>Currently enabled start-up items on this machine &ndash;
	for review</I> configuration parameter looking for suspicious
	entries. When you find an entry that you think is suspicious, you
	should copy the executable or dll name and search for it using a
	search engine such as Google.</P>
</OL>
<P STYLE="margin-left: 0.51in">To make this process easier, you can
copy the content of the <I>Currently enabled start-up items on this
machine &ndash; for review</I> configuration parameter, and paste
them into an empty plain text file.</P>
<OL START=5>
	<LI><P>If the search engine search returns no results, or reports
	results that identify the item as malware, copy the entire entry
	(from the <I>Currently enabled start-up items on this machine &ndash;
	for review</I> configuration parameter), into the Scrip 233 and 240
	malware item text file for the system your are working on.</P>
	<LI><P>Repeat steps 4 and 5 until you have reached the end of the
	list of items in the <I>Currently enabled start-up items on this
	machine &ndash; for review</I> configuration parameter on the system
	you are working on.</P>
</OL>
<OL START=7>
	<LI><P>Select all the items you have added from the <I>Currently
	enabled start-up items on this machine &ndash; for review</I>
	configuration parameter in the Scrip 233 configuration page to the
	<I>Scrip 233</I> section of the Scrip 233 and 240 malware item text
	file for the system your are working on, and copy them. Switch to
	the Scrip 233 items to be disabled master list, go to the end of the
	file, enter a few blank lines, and paste the items you copied from
	the <I>Scrip 233</I> section of the Scrip 233 and 240 malware item
	text file for the system your are working on.</P>
	<P><B>Please be very careful to select and copy the items that you
	added from the <I>Currently enabled start-up items on this machine</I>
	configuration parameter in the Scrip 233 configuration page, not
	from Scrip 240. Otherwise the malware clean-up operation will not
	work.</B></P>
	<LI><P>Verify that the items you just pasted from the <I>Scrip 233</I>
	section of the Scrip 233 and 240 malware item text file for the
	system your are working on are not already present in the the Scrip
	233 items to be disabled master list (search for the name of the
	dll, or other distinguishing character string in the item you are
	searching duplicates for). If they are, simply delete them. Once you
	have completed this verification process, eliminate the blank lines
	separating the entries you pasted from the Scrip 233 and 240 malware
	item text file for the system your are working, and the other
	entries. Make sure that there are no blank lines separating items in
	the Scrip 233 items to be disabled master list. Save the file.</P>
	<P>Note that you would be well advised to keep machine specific and
	user specific items in the Scrip 233 items to be disabled master
	list grouped together with the machine specific item group coming
	before the user specific item group. In this way, it will be easier
	to use the master list content at new sites where user specific
	items from existing sites are not relevant.</P>
	<P>Please also note that there would be no adverse effect if you had
	user specific items from one site, entered in the Items to be
	disabled configuration parameter at another site.</P>
	<LI><P>Select all content of the Scrip 233 items to be disabled
	master list, and copy it. Go back to the Scrip 233 configuration
	page of the system you are working on. Delete all entries from the
	<I>Items to be disabled</I> configuration parameter. Paste the items
	copied from the Scrip 233 items to be disabled master list.</P>
	<LI><P>If you found no suspicious items in the running processes
	list reported by Scrip 93 in step 3, run Scrip 233 on demand by
	clicking on the <I>Update start-up items now</I> <I>Execute</I>
	button (selecting machine <B>&lt;machine name&gt;</B> from the
	pull-down list to the right of the <I>Execute</I> button), then
	proceed to step 11. Otherwise, click on the <I>Submit Changes</I>
	button at the bottom (or at the top) of the Scrip 233 configuration
	page, then proceed to step 11.</P>
</OL>
<HR>
<P><BR><BR>
</P>
<OL START=7>
	<LI VALUE=11><P>Access the Scrip 240 configuration page for the
	system you are working on (via the ASI server or locally). Examine
	the entries in the <I>Currently enabled start-up items on this
	machine &ndash; for review</I> configuration parameter looking for
	suspicious entries. 
	</P>
</OL>
<OL START=12>
	<LI VALUE=12><P>When you find an entry that you think is suspicious,
	you should copy the executable or dll name and search for it using a
	search engine such as Google.</P>
</OL>
<P STYLE="margin-left: 0.55in">To make this process easier, you can
copy the content of the <I>Currently enabled start-up items on this
machine &ndash; for review</I> configuration parameter, and paste
them into an empty plain text file.</P>
<OL START=13>
	<LI VALUE=13><P>If the search engine search returns no results, or
	reports results that identify the item as malware, copy the entire
	entry (from the Currently enabled start-up items on this machine
	configuration parameter), into the <I>Scrip 240</I> section of the
	Scrip 233 and 240 malware item text file for the system your are
	working on.</P>
	<LI><P>Repeat steps 12 and 13 until you have reached the end of the
	list of items in the <I>Currently enabled start-up items on this
	machine &ndash; for review</I> configuration parameter on the system
	you are working on.</P>
</OL>
<OL START=15>
	<LI VALUE=15><P>Select all the items you have added from the
	<I>Currently enabled start-up items on this machine &ndash; for
	review</I> configuration parameter in the Scrip 240 configuration
	page to the <I>Scrip 240</I> section of the Scrip 233 and 240
	malware item text file for the system your are working on, and copy
	them. Switch to the Scrip 240 items to be disabled master list, go
	to the end of the file, enter a few blank lines, and paste the items
	you copied from the Scrip 233 and 240 malware item text file for the
	system your are working on.</P>
</OL>
<P STYLE="margin-left: 0.52in"><B>Please be very careful to select
and copy the items that you added from the <I>Currently enabled
start-up items on this machine</I> configuration parameter in the
Scrip 233 configuration page, not from Scrip 240. Otherwise the
malware clean-up operation will not work.</B></P>
<OL START=16>
	<LI VALUE=16><P>Verify that the items you just pasted from the <I>Scrip
	240</I> section of the Scrip 233 and 240 malware item text file for
	the system your are working on are not already present in the the
	Scrip 240 items to be disabled master list (search for the name of
	the dll, or other distinguishing character string in the item you
	are searching duplicates for). If they are, simply delete them. Once
	you have completed this verification process, eliminate the blank
	lines separating the entries you pasted from the <I>Scrip 240</I>
	section of the Scrip 233 and 240 malware item text file for the
	system your are working, and the other entries. Make sure that there
	are no blank lines separating items in the Scrip 240 items to be
	disabled master list. Save the file.</P>
</OL>
<P STYLE="margin-left: 0.5in">Note that you would be well advised to
keep machine specific, user specific, and hosts file entries items in
the Scrip 240 items to be disabled master list grouped together with
the machine specific item group coming first, the hosts entries next,
and the user specific item group last. In this way, it will be easier
to use the master list content at new sites where user specific items
from existing sites are not relevant.</P>
<P STYLE="margin-left: 0.5in">Please also note that there would be no
adverse effect if you had user specific items from one site, entered
in the <I>Items to be disabled</I> configuration parameter at another
site.</P>
<OL START=17>
	<LI VALUE=17><P>Select all content of the Scrip 240 items to be
	disabled master list, and copy it. Go back to the Scrip 240
	configuration page of the system you are working on. Delete all
	entries from the <I>Items to be disabled</I> configuration
	parameter. Paste the items copied from the Scrip 240 items to be
	disabled master list.</P>
	<LI><P>Examine the entries in the <I>Current configuration settings
	on this machine &ndash; for review</I> configuration parameter.
	Focus on the machine and user Microsoft Internet Explorer Start,
	Search, Search Assistant, and Customize Search page configuration
	entries. All other items, typically are legitimate. <B>However, we
	would strongly caution you against by-passing the review of these
	items. </B>
	</P>
</OL>
<P STYLE="margin-left: 0.53in">To make this process easier, you can
copy the content of the <I>Current configuration settings on this
machine &ndash; for review</I> configuration parameter, and paste
them into an empty plain text file.</P>
<OL START=19>
	<LI VALUE=19><P>When you find a Microsoft Internet Explorer
	configuration entry that you think is suspicious, you should copy
	the URL and search for it using a search engine such as Google.</P>
	<LI><P>If the search engine search returns no results, or reports
	results that identify the item as malware, copy the entire entry
	(from the <I>Current configuration settings on this machine &ndash;
	for review</I> configuration parameter), into the <I>Configuration
	settings</I> section of the Scrip 233 and 240 malware item text file
	for the system your are working on.</P>
	<LI><P>Repeat steps 18-20 until you have reached the end of the list
	of items in the <I>Current configuration settings on this machine &ndash;
	for review</I> configuration parameter on the system you are working
	on.</P>
	<LI><P>Select and copy the machine and user Microsoft Internet
	Explorer configuration items in the <I>Configuration settings</I>
	section of the Scrip 233 and 240 malware item text file, and paste
	them in the the <I>Configuration settings to enforce</I> section in
	the same file. 
	</P>
	<LI><P>Change the URLs to ones that are acceptable to the
	organization.</P>
	<LI><P>Select and copy the machine and user Microsoft Internet
	Explorer configuration items in the <I>Configuration settings to
	enforce</I> section of the Scrip 233 and 240 malware item text file.
	Go back to the Scrip 240 configuration page of the system you are
	working on. Paste them into the <I>Configuration settings to enforce</I>
	configuration parameter making sure that you select <B>site &lt;name&gt;</B>
	from the <I>Group</I> pull-down list for the <I>Configuration
	settings to enforce</I> configuration parameter.</P>
</OL>
<P STYLE="margin-left: 0.53in">Unless the site where the system you
are working on is located has a site wide policy to enforce both
machine and user Microsoft Internet Explorer configuration settings,
you need to deal with malware Microsoft Internet Explorer
configuration settings on a case-by case basis. This is why we
suggest that you select <B>machine &lt;name&gt;</B> from the <I>Group</I>
pull-down list for the <I>Configuration settings to enforce</I>
configuration parameter. 
</P>
<P STYLE="margin-left: 0.53in">You should take special care when
modifying Scrip 240's configuration to replace the items in the
<I>Current configuration settings on this machine &ndash; for review
(and known)</I> configuration parameter using the <I>Configuration
settings to enforce</I> configuration parameter. If you choose to
disable entries such as 
</P>
<P STYLE="margin-left: 0.53in"><B>RegKey,,HKEY_LOCAL_MACHINE\Software\Microsoft\Internet
Explorer\Main,Start
Page,http://www.microsoft.com/isapi/redir.dll?prd={SUB_PRD}&amp;clcid={SUB_CLSID}&amp;pver={SUB_PVER}&amp;ar=home</B></P>
<P STYLE="margin-left: 0.53in">and 
</P>
<P STYLE="margin-left: 0.53in"><B>RegKey,adonnini,HKEY_USERS\.Default\Software\Microsoft\Internet
Explorer\Main,Start Page,about:blank</B></P>
<P STYLE="margin-left: 0.53in">respectively a system's, and user's MS
Internet Explorer start page settings, using the Items to be disabled
configuration parameter you will render MS Internet Explorer on the
system unusable because Scrip 240 will not replace them with valid
entries.</P>
<P STYLE="margin-left: 0.53in">If you delete only a user's MS
Internet Explorer start page but not a system's MS Internet Explorer
start page users on the system will still be able to use MS Internet
Explorer as the browser will default to the system's start page.</P>
<P STYLE="margin-left: 0.53in">The above consideration is also true
for other MS Internet Explorer configuration settings although
deletion of the others does not have the same drastic impact as
deletion of the start page setting.</P>
<OL START=25>
	<LI VALUE=25><P>If you found no suspicious items in the running
	processes list reported by Scrip 93 in step 3, run Scrip 240 on
	demand by clicking on the <I>Update intrusion protection now</I>
	<I>Execute</I> button (selecting <B>machine &lt;name&gt;</B> from
	the <I>Group</I> pull-down list to the right of the <I>Execute</I>
	button), then proceed to step 34. Otherwise, click on th <I>Submit
	Changes</I> button at the bottom (or at the top) of the Scrip 240
	configuration page, then proceed to step 26.</P>
</OL>
<HR>
<P><BR><BR>
</P>
<OL START=25>
	<LI VALUE=26><P>Access the Scrip 227 (Process and Service
	Shutdown-Restart) configuration page for the system you are working
	on (via the ASI server or locally).</P>
</OL>
<OL START=27>
	<LI><P><FONT FACE="Verdana, sans-serif">In the <I>Process groups</I>
	configuration parameter, on a new line enter a new process group
	with the name of the system you are working for. After typing in (or
	pasting) the name of the system, type a comma and then past the
	comma delimited list of process names from the text file used in
	step 3. The entry would look something like this:</FONT></P>
</OL>
<P STYLE="margin-left: 0.99in"><FONT FACE="Verdana, sans-serif"><B>&lt;machine
name&gt;,&lt;comma delimited list of process names from text file
used in step 3&gt;</B></FONT></P>
<P STYLE="margin-left: 0.56in"><FONT FACE="Verdana, sans-serif">Note
that you could create a single process group and call it spyware, for
example. Whichever approach you use, you should leave the Process
groups configuration parameter <I>Group</I> parameter selection set
to <B>site &lt;site name&gt;</B>.</FONT></P>
<OL START=28>
	<LI VALUE=28><P><FONT FACE="Verdana, sans-serif">Enter the name of
	the new process group, into both the <I>Scheduled shutdown</I> and
	<I>On demand shutdown</I> Scrip 227 configuration parameters.</FONT></P>
	<LI><P><FONT FACE="Verdana, sans-serif">Run Scrip 227 on demand by
	clicking on the <I>Process on demand items now</I> <I>Execute</I>
	button.</FONT></P>
	<LI><P><FONT FACE="Verdana, sans-serif">Retrieve the Scrip 227 event
	logs to verify that the processes you wanted it to shut down were
	indeed terminated.</FONT></P>
	<LI><P><FONT FACE="Verdana, sans-serif">Run Scrip 93 (Report Running
	Processes) on demand again. Retrieve the Scrip 93 event log
	containing the list of currently running processes on the system and
	verify that the malware processes you terminated using Scrip 227
	have not restarted again. If they have, consider using Scrip 192 to
	prevent them from running as described in the <I>Using Scrip 192 to
	prevent malware process execution</I> section at the end of this
	document.</FONT></P>
</OL>
<P STYLE="margin-left: 0.51in"><FONT FACE="Verdana, sans-serif"><B>In
general, if Scrip 93 (Report Running Processes) reports that malware
processes are running on the system you are working on, you could
by-pass the running process clean-up steps (26-31) by either using
Scrip 73 to re-start the system, or asking the end-user to do so.
Re-starting the system, will shut down all processes and re-start
only the processes in the start-up environment protected by Scrip 27,
and not disabled by Scrip 233. If you choose to follow this path,
performing steps 32 and 33 serves as an insurance policy.</B></FONT></P>
<OL START=32>
	<LI VALUE=32><P><FONT FACE="Verdana, sans-serif">Run Scrip 233 on
	demand by clicking on the <I>Update start-up items now</I> <I>Execute</I>
	button. </FONT>
	</P>
	<LI><P><FONT FACE="Verdana, sans-serif">Run Scrip 240 on demand by
	clicking on the <I>Update intrusion protection now</I> <I>Execute</I>
	button.</FONT></P>
	<LI><P><FONT FACE="Verdana, sans-serif">Retrieve the Scrip 233 event
	logs for the system you have been working. If it's a system where
	the ASI client was recently installed, run the Scrip 233 event log
	query covering a period starting from the time at which the ASI
	client was installed until just after your on-demand execution of
	Scrip 233.</FONT></P>
</OL>
<HR>
<P><BR><BR>
</P>
<OL START=34>
	<LI VALUE=35><P><FONT FACE="Verdana, sans-serif">Retrieve the Scrip
	240 event logs for the system you have been working. If it's a
	system where the ASI client was recently installed, run the Scrip
	240 event log query covering a period starting from the time at
	which the ASI client was installed until just after your on-demand
	execution of Scrip 240.</FONT></P>
	<LI><P><FONT FACE="Verdana, sans-serif">Retrieve Scrip 27 (System
	Start-up Environment Control) event logs from the system you have
	been working on. If it's a system where the ASI client was recently
	installed, run the Scrip 27 event log query covering a period
	starting from the time at which the ASI client was installed until
	just after your on-demand execution of Scrip 233.</FONT></P>
</OL>
<P STYLE="margin-left: 0.56in"><FONT FACE="Verdana, sans-serif">Note
that Scrip 27 event logs help you determine whether malware is still
active on a system as evidenced by attempts to change its start-up
environment. The Scrip 27 event logs tell you which malware the Scrip
is preventing from changing the system's start-up environment.
Typically, it will be a hidden executable.</FONT></P>
<OL START=37>
	<LI VALUE=37><P><FONT FACE="Verdana, sans-serif">Retrieve Scrip 232
	(Intrusion Protection Control) event logs from the system you have
	been working on. If it's a system where the ASI client was recently
	installed, run the Scrip 232 event log query covering a period
	starting from the time at which the ASI client was installed until
	just after your on-demand execution of Scrip 240.</FONT></P>
</OL>
<P STYLE="margin-left: 0.57in"><FONT FACE="Verdana, sans-serif">Note
that Scrip 232 event logs help you determine whether malware is still
active on a system as evidenced by attempts to change its
configuration. The Scrip 232 event logs tell you which malware the
Scrip is preventing from changing the system's configuration.
Typically, it will be a hidden executable.</FONT></P>
<OL START=38>
	<LI VALUE=38><P><FONT FACE="Verdana, sans-serif">If the number of
	logs retrieved in step 27 and/or 28 over a period of 10-15 minutes
	is significant (&gt;50 each), you should run Scrip 93 (Report
	Running Processes) again to determine whether a malware executable
	was started again by another hidden component. If this is the case
	you should configure Scrip 192 (Program Execution Control) to
	prevent the execution of the malware executable you found in the
	list of running processes retrieved by Scrip 93, and use Scrip 227
	(Process and Service Shutdown-Restart) to stop the malware
	process(es)) (repeat steps 18-22). </FONT>
	</P>
</OL>
<P STYLE="margin-left: 0.56in"><FONT FACE="Verdana, sans-serif">Note
that as soon as the upcoming ASI hidden executable neutralization
function becomes available, the occurrence of significant numbers of
Scrip 27 and/or Scrip 232 event logs reporting the neutralization of
hidden executable activities should be minimized.</FONT></P>
<H5>Using Scrip 192 to prevent malware process execution</H5>
<P>If you find malware processes running on a system, and you want to
stop them, and prevent them from running in the future, you should
first configure Scrip 192 to prevent their execution, and then use
Scrip 227 to stop them. It is important to first enable and configure
Scrip 192 to stop future execution, and then run Scrip 227 to stop
current execution</P>
<P><FONT FACE="Verdana, sans-serif"><B>If you are going to use Scrip
192 (Program Execution Control), you should make sure that:</B></FONT></P>
<OL>
	<LI VALUE=1><P><FONT FACE="Verdana, sans-serif"><B>The Scrip is
	enabled on the system where you want to prevent execution of one ore
	more programs by selecting &ldquo;machine &lt;machine name&gt;&rdquo;
	from the <I>Group</I> parameter pull-down list for the <I>Scrip
	enabled</I> configuration parameter, and </B></FONT>
	</P>
	<LI><P><FONT FACE="Verdana, sans-serif"><B>The <I>Use Stop List
	parameters to terminate execution of selected programs (checked)
	/Use Run List parameters to allow execution of selected programs
	(unchecked)</I> configuration parameter is enabled (box checked), </B></FONT>
	</P>
	<LI><P><FONT FACE="Verdana, sans-serif"><B>The processes you want to
	prevent from running are entered in the <I>Stop List (stop these
	programs from running)</I> configuration parameter each on a new
	line with no path required.</B></FONT></P>
	<LI><P><FONT FACE="Verdana, sans-serif"><B>The <I>Display a message
	when a program is terminated.(Applies to both Stop List and Run List
	modes)</I> configuration parameter is disabled (box unchecked).</B></FONT></P>
</OL>
<P><FONT FACE="Verdana, sans-serif"><B>Important note</B></FONT></P>
<P><FONT FACE="Verdana, sans-serif"><B>In some cases, a hidden
malware component may get into a &ldquo;war&rdquo; with Scrip 192
trying to restart the process Scrip 192 terminates. If this is the
case by tracking the Scrip 192 event logs (as you will see by
tracking the Scrip 192 event logs), you should disable Scrip 192 and,
instead, use Scrip 73 (System Restart) to re-start the system.
Re-starting the system, will shut down all processes and re-start
only the processes in the start-up environment protected by Scrip 27,
and cleaned up by Scrip 233. Depending on the customer situation, you
may not be able to use Scrip 73 to re-start the system in which case
you should ask the end-user to do so.</B></FONT></P>
</BODY>
</HTML>