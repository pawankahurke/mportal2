<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>Scrip 227 Configuration</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.1.0  (Win32)">
	<META NAME="CREATED" CONTENT="20031020;13233299">
	<META NAME="CHANGEDBY" CONTENT="Alessandro Donnini">
	<META NAME="CHANGED" CONTENT="20040116;10122092">
	<STYLE>
	<!--
		TD P { font-family: "verdana"; font-size: 10pt }
		P { font-family: "verdana"; font-size: 10pt }
		H3 { color: #333399; font-family: "verdana" }
		H4 { color: #333399; font-family: "verdana" }
		A:link { color: #333399 }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" LINK="#333399" DIR="LTR">
<H3>Scrip 227 Configuration</H3>
<H4>Configuration parameters &ndash; default values</H4>
<UL>
	<LI><P STYLE="margin-bottom: 0in">Scrip disabled 
	</P>
	<LI><P STYLE="margin-bottom: 0in"><EM>Process groups</EM> empty 
	</P>
	<LI><P STYLE="margin-bottom: 0in"><EM>Max number of seconds to wait
	for the process to close</EM> 30 seconds 
	</P>
	<LI><P STYLE="margin-bottom: 0in"><EM>Max number of dialogs to close</EM>
	5 
	</P>
	<LI><P STYLE="margin-bottom: 0in"><EM>Service groups</EM> empty 
	</P>
	<LI><P STYLE="margin-bottom: 0in"><EM>Scheduled shutdown</EM> empty 
	</P>
	<LI><P STYLE="margin-bottom: 0in"><EM>Scheduled restart</EM> empty 
	</P>
	<LI><P STYLE="margin-bottom: 0in"><EM>On-demand shutdown</EM> empty 
	</P>
	<LI><P STYLE="margin-bottom: 0in"><EM>On-demand restart</EM> empty 
	</P>
	<LI><P STYLE="margin-bottom: 0in">When enabled, by default Scrip 227
	runs once a day at 4 AM 
	</P>
	<LI><P><EM>Process on demand items now</EM> 
	</P>
</UL>
<H4>Process groups</H4>
<P><EM>Process groups</EM> parameter entries have the following
format:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0in">Name of a process group followed
	by a comma with no spaces 
	</P>
	<LI><P>Names of processes that are in the named group, each
	separated by a comma with no spaces. Each process name is a filename
	that can include the standard Microsoft MS-DOS wild card characters,
	<STRONG>?</STRONG> and <STRONG>*</STRONG>. You can also exclude one
	or more processes from being shut down by adding an exclamation
	point before the process name (which could include wild cards). For
	example: 
	</P>
	<PRE>apps,winword.exe,excel.exe,epsilon.exe

background,*.scr,*.exe,!explorer.exe,!cust.exe</PRE><P>
	When Scrip 227 shuts down the processes in process group <EM>background</EM>,
	it will shut down all screen savers and all executables except for
	Microsoft Windows Explorer and the ASI client. 
	</P>
</UL>
<P>You can define as many <EM>Process groups</EM> entries as you want
with each group entered on a new line.</P>
<H4>Max number of seconds to wait for the process to close</H4>
<P>Once the system reboot sequence has been initiated, this parameter
lets you control how long Scrip 227 should wait before shutting down
each process that was active at the time.</P>
<H4>Max number of dialogs to close</H4>
<P>In many instances, requests for user action communicated via
dialog boxes are part of process shut down sequences. Scrip 227
handles these requests automatically.</P>
<P>Whenever a dialog box appears during a process' shut down sequence
requesting user input, Scrip 227 closes it taking the default action.
For example, if the dialog box requests whether a file should be
saved or not, and the default response is <STRONG>Yes</STRONG>, Scrip
227 will automatically click on the <STRONG>Yes</STRONG> button.</P>
<H4>Service groups</H4>
<P><EM>Service groups</EM> parameter entries have the following
format:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0in">Name of a service group followed
	by a comma with no spaces 
	</P>
	<LI><P>Names of services that are in the named group, each separated
	by a comma with no spaces. Each service name is just the name of the
	service as it appears in the service manager. An example is: 
	</P>
	<PRE>rpc,Remote Procedure Call (RPC),Remote Procedure Call (RPC) Locator
network,DHCP Client,DNS Client,Server,Workstation</PRE>
</UL>
<P>You can define as many <EM>service groups</EM> entries as you want
with each group entered on a new line.</P>
<H4>Note on restart and shutdown</H4>
<P>The order in which services are listed in a service group is
<STRONG>critical</STRONG> for a successful restart of services shut
down by Scrip 227. You should list services that depend on other
services first. Scrip 227 shuts down services in the order in which
they appear in a service group entry. It will restart them in the
reverse order. In this way, dependent services are shut down first
and restarted last.</P>
<P>For example, if service <STRONG>A</STRONG> depends on service <STRONG>B</STRONG>
and they are in group <STRONG>X</STRONG> then the entry for service
group <STRONG>X</STRONG> would be:<BR><BR><STRONG>X,A,B</STRONG> 
</P>
<P><B>Please note that only executables and services that are shut
down by Scrip 227 can be restarted by the Scrip. In other words, the
Scrip will not shut down a process or service unless it first shut it
down. This means that in order for the services or processes in a
group to be restarted, their group needs to be included in both the
</B><EM><B>Scheduled shut down</B></EM> <B>and </B><EM><B>Scheduled
restart</B></EM> <B>parameters, or the </B><EM><B>On-demand shut down</B></EM>
<B>and </B><EM><B>On-demand restart</B></EM> <B>parameters.</B></P>
<P>the <EM>restart</EM> lists (on demand or scheduled) specify a
proper subset of the corrsponding <EM>shutdown</EM> lists (on demand
or scheduled. This means that Scrip 227 first shuts down everything
in the <EM>shutdown</EM> list, then start up anything that was
successfully shut down that is in the corresponding <EM>restart</EM>
list. For example, if the <EM>shutdown</EM> list is <STRONG>a,b,c</STRONG>
and the <EM>restart</EM> list is <STRONG>c,d,e</STRONG>, Scrip 227
will shutdown <STRONG>a</STRONG>, shutdown <STRONG>b</STRONG>,
shutdown <STRONG>c</STRONG>, and startup <STRONG>c</STRONG>.</P>
<P>When you're using wildcards, if the shutdown list is <STRONG>abc*.*</STRONG>
and the restart list is <STRONG>*.exe</STRONG> then you might shut
down <STRONG>abcdef.com</STRONG> and <STRONG>abcxyz.exe</STRONG>,
then start up <STRONG>abcxyz.exe</STRONG>.</P>
<P>When shutting down an executable, Scrip 227 saves the exact
location of the executable and its command line parameters, so that
it could be restarted in a state that is as close as possible to its
pre-shutdown state. <BR>Scrip 227 will restart only one instance of
each process it shut down, regardless of the number of instances that
were running at the time. For example, if the Scrip shut down four
copies of Microsoft Internet Explorer, it will restart only
one.<BR>Please also note that only processes that were successfully
shut down will be restarted.</P>
<P>Scrip 227 lets you selectively restart processes that it shut down
. For example, you can configure it to shut down *.exe but only
restart foo.exe.</P>
<H4>Scheduled shutdown</H4>
<P>The <EM>Scheduled shut down</EM> parameter consists of a list of
the processes and services that are shut down in a scheduled run. The
entries in the list are names of process groups as defined in the
<EM>Process groups</EM> parameter and service groups as defined in
the <EM>Service groups</EM> parameter, each on a separate line.</P>
<P>Please note that you can inter-mix process group and service group
names without constraint.</P>
<H4>Scheduled restart</H4>
<P>The <EM>Scheduled restart</EM> parameter consists of a list of the
processes and services that are shut down, then restarted in a
scheduled run. The entries in the list are names of process groups as
defined in the <EM>Process groups</EM> parameter and service groups
as defined in the <EM>Service groups</EM> parameter, each on a
separate line.</P>
<P>Please note that you can inter-mix process group and service group
names without constraint.</P>
<H4>On-demand shutdown</H4>
<P>The <EM>On-demand shut down</EM> parameter consists of a list of
the processes and services that are shut down when Scrip 227 is run
on demand (by clicking on the <EM>Execute</EM> button to the right of
the <EM>Process on demand items now</EM> label). The entries in the
list are names of process groups as defined in the <EM>Process groups</EM>
parameter and service groups as defined in the <EM>Service groups</EM>
parameter, each on a separate line.</P>
<P>Please note that you can inter-mix process group and service group
names without constraint.</P>
<H4>On-demand restart</H4>
<P>The <EM>On-demand restart</EM> parameter consists of a list of the
processes and services that are shut down, then restarted when Scrip
227 is run on demand (by clicking on the <EM>Execute</EM> button to
the right of the <EM>Process on demand items now</EM> label). The
entries in the list are names of process groups as defined in the
<EM>Process groups</EM> parameter and service groups as defined in
the <EM>Service groups</EM> parameter, each on a separate line.</P>
<P>Please note that you can inter-mix process group and service group
names without constraint.</P>
<H4>Shut down processes now</H4>
<P>With the <EM>Execute</EM> button, you can run Scrip 227 on demand,
even if it's not enabled. In Scrip 227, the <EM>Execute</EM> button
can be used to execute the Scrip only on the local system. When you
click on the <EM>Execute</EM> button, Scrip 227 runs immediately,
shutting down the processes and services identified by the <EM>On-demand
shut down</EM> parameter, and restarting the processes and services
identified by the <EM>On-demand restart</EM> parameter.</P>
<H4>Note on Scrip 227 use</H4>
<P>Scrip 227 can have a <EM>bimodal</EM> mode of operation. It can be
used to perform remotely and automatically the following functions:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0in"><EM>Scheduled shutdown</EM>. In
	this mode, Scrip 227 would be used, for example, to perform an
	orderly shutdown of all active applications before starting a
	regularly scheduled backup process. To use the Scrip this way, it is
	enabled, and the schedule is set up to run as desired. 
	</P>
	<LI><P><EM>On-demand shutdown</EM>. In this mode, Scrip 227 would be
	used, for example, if a notification generated by the ASI server, or
	other alert (or a phone call) informed an administrator that he/she
	needed to shut down certain process(es) and/or service(s) remotely.
	To use the Scrip to perform this action, it does not have to be
	enabled. The administrator simply clicks on the <EM>Execute</EM>
	button to the right of the <EM>Shut down processes now</EM> label to
	shut down the process(es) and/or service(s). 
	</P>
</UL>
<P>Please note that the <EM>On-demand shut down</EM> and <EM>On-demand
restart</EM> parameters perform a one-time shutdown/restart of
selected process(es)/service(s),without changing (and possibly
introducing an error into) the scheduled shutdown and/or restart of
services and processes.</P>
<H4>Schedule</H4>
<P>The Schedule parameter has a command line with eight fields, each
entered on a new line.</P>
<P>The table below describes each field in detail.</P>
<TABLE BORDER=1 BORDERCOLOR="#c0c0c0" CELLPADDING=3 CELLSPACING=0>
	<TR>
		<TD>
			<P ALIGN=CENTER><STRONG>Field Number</STRONG> 
			</P>
		</TD>
		<TD>
			<P ALIGN=CENTER><STRONG>Field Name</STRONG> 
			</P>
		</TD>
		<TD>
			<P ALIGN=CENTER><STRONG>Field Values and Description</STRONG> 
			</P>
		</TD>
		<TD></TD>
	</TR>
	<TR>
		<TD>
			<P>1</P>
		</TD>
		<TD>
			<P>Minutes</P>
		</TD>
		<TD>
			<P>0-60</P>
		</TD>
		<TD VALIGN=TOP></TD>
	</TR>
	<TR>
		<TD>
			<P>2</P>
		</TD>
		<TD>
			<P>Hours</P>
		</TD>
		<TD>
			<P>1-24</P>
		</TD>
		<TD VALIGN=TOP></TD>
	</TR>
	<TR>
		<TD>
			<P>3</P>
		</TD>
		<TD>
			<P>Day of the Month</P>
		</TD>
		<TD>
			<P>1-31, depending on the month; a value of * means that the Scrip
			should be run every day.</P>
		</TD>
		<TD VALIGN=TOP></TD>
	</TR>
	<TR>
		<TD>
			<P>4</P>
		</TD>
		<TD>
			<P>Month</P>
		</TD>
		<TD>
			<P>1-12; a value of * means that the Scrip should be run every
			month.</P>
		</TD>
		<TD VALIGN=TOP></TD>
	</TR>
	<TR>
		<TD>
			<P>5</P>
		</TD>
		<TD>
			<P>Day of the Week</P>
		</TD>
		<TD>
			<P>0, Sunday - 6, Saturday; a value of * means that the Scrip
			should be run every day of the week.</P>
		</TD>
		<TD VALIGN=TOP></TD>
	</TR>
	<TR>
		<TD>
			<P>6</P>
		</TD>
		<TD>
			<P>Minute Randomizer</P>
		</TD>
		<TD>
			<P>N; the size of the time interval in minutes over which the
			Scrip should be randomly executed. We multiply N*60, then
			calculate a random number X between 1 and N*60, and run the Scrip
			X seconds after its scheduled time.</P>
		</TD>
		<TD VALIGN=TOP></TD>
	</TR>
	<TR>
		<TD>
			<P>7</P>
		</TD>
		<TD>
			<P>Conditional Execution</P>
		</TD>
		<TD>
			<P>N; N=1 means that if the Scrip is past due, it will be run
			immediately, N=2 means that If the Scrip is past due, it will be
			run at the next scheduled execution time. If the value is set to
			2, the actual Scrip execution time will be within 3 minutes
			(either way) of the scheduled time. This is necessary to prevent
			the case where a process will not be executed if it is a little
			slow to start, or if the scheduler starts it a few seconds too
			early.</P>
		</TD>
		<TD VALIGN=TOP></TD>
	</TR>
	<TR>
		<TD>
			<P>8</P>
		</TD>
		<TD>
			<P>Failed Run Limit</P>
		</TD>
		<TD>
			<P>N, where N is the number of times that Scrip execution is
			allowed to fail before notification is sent to the support
			provider; N=0, the Scrip will NEVER report a failure, N=1, the
			Scrip will report EVERY failure, N=2, the Scrip will report if it
			failed twice in a row, and so on.</P>
		</TD>
		<TD VALIGN=TOP></TD>
	</TR>
</TABLE>
<P>The <EM>Minutes</EM>, <EM>Hours</EM>, <EM>Day of the Month</EM>,
<EM>Month</EM>, and <EM>Day of the Week</EM> fields can have multiple
values and ranges of values separating them with commas.</P>
<P>For example, a 1,3,5 entry for the <EM>Minutes</EM> parameter
would mean that a Scrip would be executed at minutes 1, 3, and 5.</P>
<P>A 10-14 entry for the <EM>Hours</EM> parameter would mean that a
Scrip would be executed starting at 10 AM and ending at 2 PM.</P>
<P>Multiple value and range entries can be used together separated by
commas.</P>
<P><BR><BR><BR>
</P>
<HR SIZE=1 COLOR="#333399" NOSHADE>
<DIV ALIGN=RIGHT>
	<TABLE WIDTH=100% BORDER=0 CELLPADDING=0 CELLSPACING=0>
		<TR>
			<TD WIDTH=50% VALIGN=TOP>
				<P><FONT FACE="verdana, helvetica"><FONT SIZE=1>&copy; 2000-2002
				HandsFree Networks </FONT></FONT>
				</P>
			</TD>
		</TR>
	</TABLE>
</DIV>
<P><BR><BR>
</P>
</BODY>
</HTML>